<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>çˆ±å¿ƒè¿½å°èŠ³</title>
    <style>
        body { margin: 0; overflow: hidden; background: #ffe6f2; }
        #gameCanvas { width: 100%; height: 100vh; display: none; } /* åˆå§‹éšè— */
        #score { position: absolute; top: 10px; right: 10px; font-size: 24px; color: #ff1493; font-family: Arial, sans-serif; }
        #startButton {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            padding: 15px 30px;
            font-size: 24px;
            color: white;
            background: #ff1493;
            border: none;
            border-radius: 10px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div id="score">å‡»è´¥å°èŠ³ï¼š0æ¬¡</div>
    <canvas id="gameCanvas"></canvas>
    <button id="startButton">å¼€å§‹æ¸¸æˆ</button>

<script>
// è‡ªåŠ¨é€‚é…æ‰‹æœºå…¨å±
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

// ğŸ® æ¸¸æˆå‚æ•°
let playerX = canvas.width/2;
let hearts = [];
let enemies = [];
let score = 0; // å‡»è´¥æ¬¡æ•°
let gameStarted = false; // æ¸¸æˆæ˜¯å¦å¼€å§‹
const config = {
    heartSpeed: 8,        // çˆ±å¿ƒé€Ÿåº¦
    enemySpeed: 0.2,      // æ•Œäººä¸‹è½é€Ÿåº¦
    spawnRate: 0.015,     // æ•Œäººç”Ÿæˆç‡
    fireworkParticles: 30 // çƒŸèŠ±ç²’å­æ•°é‡
};

// ğŸ’– æ›¿æ¢æˆä½ çš„ç…§ç‰‡ï¼ˆä¸¤ç§æ–¹æ³•ä»»é€‰å…¶ä¸€ï¼‰
// æ–¹æ³•1ï¼šå°†æ‰‹æœºç…§ç‰‡è½¬æˆBase64ï¼ˆæ¨èç”¨è¿™ä¸ªç½‘ç«™è½¬ï¼šhttps://base64.guru/converter/encode/imageï¼‰
const enemyImg = new Image();
enemyImg.src = 'æ°.jpg'; // âœ‚ï¸æ›¿æ¢è¿™é‡Œï¼

// æ–¹æ³•2ï¼šæŠŠç…§ç‰‡ä¸Šä¼ åˆ°ç½‘ç»œç›¸å†Œï¼Œæ›¿æ¢ä¸‹æ–¹é“¾æ¥
// enemyImg.src = 'ä½ çš„ç½‘ç»œå›¾ç‰‡é“¾æ¥';

// åŠ è½½çˆ±å¿ƒå›¾ç‰‡
const heartImg = new Image();
heartImg.src = 'èŠ³.jpg'; // é—ªå…‰çˆ±å¿ƒ

// ğŸ† å½©è‰²çƒŸèŠ±ç‰¹æ•ˆ
function createFirework(x, y) {
    const particles = [];
    for(let i=0; i<config.fireworkParticles; i++) {
        particles.push({
            x: x,
            y: y,
            color: `hsl(${Math.random()*360}, 100%, 50%)`, // éšæœºå½©è™¹è‰²
            speed: Math.random()*3 + 1,
            angle: Math.random()*Math.PI*2,
            life: 1.5 // ç²’å­å­˜æ´»æ—¶é—´ï¼ˆç§’ï¼‰
        });
    }

    function animate() {
        particles.forEach((p, i) => {
            if(p.life <= 0) return;
            
            // ç²’å­è¿åŠ¨
            p.x += Math.cos(p.angle) * p.speed;
            p.y += Math.sin(p.angle) * p.speed;
            p.life -= 0.02;

            // ç»˜åˆ¶ç²’å­
            ctx.globalAlpha = p.life;
            ctx.fillStyle = p.color;
            ctx.beginPath();
            ctx.arc(p.x, p.y, 3*p.life, 0, Math.PI*2);
            ctx.fill();
        });

        ctx.globalAlpha = 1; // æ¢å¤é€æ˜åº¦
        requestAnimationFrame(animate);
    }
    animate();
}

// ğŸ® æ¸¸æˆä¸»å¾ªç¯
let lastTime = 0;
function gameLoop(timestamp) {
    if (!gameStarted) return; // å¦‚æœæ¸¸æˆæœªå¼€å§‹ï¼Œç›´æ¥è¿”å›

    const deltaTime = timestamp - lastTime;
    lastTime = timestamp;
    
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    
    // ç»˜åˆ¶å‘å°„å™¨ï¼ˆç²‰è‰²çˆ±å¿ƒï¼‰
    ctx.drawImage(heartImg, playerX-25, canvas.height-80, 50, 50);
    
    // ç”Ÿæˆæ•Œäººï¼ˆä½ çš„ç…§ç‰‡ï¼‰
    if(Math.random() < config.spawnRate) {
        enemies.push({
            x: Math.random()*(canvas.width-80),
            y: -80,
            width: 60,
            height: 60
        });
    }
    
    // çˆ±å¿ƒè¿åŠ¨
    hearts.forEach((heart, i) => {
        heart.y -= config.heartSpeed;
        ctx.drawImage(heartImg, heart.x-15, heart.y-15, 30, 30);
        
        // ç¢°æ’æ£€æµ‹
        enemies.forEach((enemy, j) => {
            if(heart.x > enemy.x && heart.x < enemy.x+60 &&
               heart.y > enemy.y && heart.y < enemy.y+60) {
                createFirework(heart.x, heart.y); // è§¦å‘çƒŸèŠ±
                enemies.splice(j, 1);
                hearts.splice(i, 1);
                score++; // å‡»è´¥æ¬¡æ•°+1
                document.getElementById('score').innerText = `å‡»è´¥å°èŠ³ï¼š${score}æ¬¡`; // æ›´æ–°åˆ†æ•°
            }
        });
    });
    
    // æ•Œäººè¿åŠ¨
    enemies.forEach((enemy) => {
        enemy.y += config.enemySpeed * deltaTime;
        ctx.drawImage(enemyImg, enemy.x, enemy.y, enemy.width, enemy.height);
        
        // å¤±è´¥æ¡ä»¶ï¼ˆæµªæ¼«æç¤ºï¼‰
        if(enemy.y > canvas.height - 80) {
            alert("â¤ï¸ å®è´çš„çˆ±å¿ƒæ°¸è¿œè¿½ç€ä½ ~ â¤ï¸");
            enemies = [];
        }
    });
    
    requestAnimationFrame(gameLoop);
}

// ğŸ“± è§¦æ§æ“ä½œï¼ˆç‚¹å‡»ä»»æ„ä½ç½®ç§»åŠ¨å‘å°„å™¨ï¼‰
canvas.addEventListener('touchstart', (e) => {
    if (!gameStarted) return; // å¦‚æœæ¸¸æˆæœªå¼€å§‹ï¼Œä¸å“åº”è§¦æ§
    e.preventDefault(); // é˜²æ­¢é»˜è®¤è¡Œä¸ºï¼ˆä¿®å¤å¡é¡¿ï¼‰
    playerX = e.touches[0].clientX;
    hearts.push({ x: playerX, y: canvas.height-80 }); // å‘å°„çˆ±å¿ƒ
});

// å¼€å§‹æŒ‰é’®ç‚¹å‡»äº‹ä»¶
document.getElementById('startButton').addEventListener('click', () => {
    gameStarted = true; // å¼€å§‹æ¸¸æˆ
    document.getElementById('startButton').style.display = 'none'; // éšè—æŒ‰é’®
    document.getElementById('gameCanvas').style.display = 'block'; // æ˜¾ç¤ºç”»å¸ƒ
    gameLoop(0); // å¯åŠ¨æ¸¸æˆå¾ªç¯
});

// é¢„åŠ è½½èµ„æº
window.onload = () => {
    document.getElementById('startButton').style.display = 'block'; // æ˜¾ç¤ºå¼€å§‹æŒ‰é’®
};
</script>
</body>
</html>